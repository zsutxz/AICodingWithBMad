# BMad 方法指导原则

BMad 核心和方法是一个自然语言框架，用于 AI 辅助的工作流程，其中包含人工循环处理以及软件开发。这些原则确保贡献能保持该方法的有效性。

## 核心原则

### 1. 开发 Agent 必须精简

- **最小化开发 Agent 的依赖项**：在 IDE 中工作的开发 Agent 必须具有最小的上下文开销
- **为代码节省上下文**：每一行都很重要 - 开发 Agent 应专注于编码，而不是文档
- **规划 Agent 可以更大**：在 Web UI 中使用的规划 Agent（PM、架构师）可以有更复杂的任务和依赖项
- **小文件，按需加载**：多个小的、专注的文件优于具有许多分支的大文件

### 2. 自然语言优先

- **一切都是 Markdown**：Agent、任务、模板 - 全部用纯英文编写
- **核心中没有代码**：框架本身不包含任何编程代码，只有自然语言指令
- **自包含模板**：模板被定义为具有结构化部分的 YAML 文件，其中包括元数据、工作流配置和用于内容生成的详细指令

### 3. Agent 和任务设计

- **Agent 定义角色**：每个 Agent 都是一个具有特定专业知识的角色（例如，前端开发人员、API 开发人员）
- **任务是程序**：Agent 为完成工作而遵循的逐步说明
- **模板是输出**：带有用于生成的嵌入式指令的结构化文档
- **依赖项很重要**：只明确声明需要的内容

## 实践指南

### 何时添加到核心

- 仅限通用软件开发需求
- 不会使开发 Agent 上下文臃肿
- 遵循现有的 Agent/任务/模板模式

### 何时创建扩展包

- 超出软件开发的特定领域需求
- 非技术领域（商业、健康、教育、创意）
- 专业技术领域（游戏、基础设施、移动）
- 大量文档或知识库
- 任何会使核心 Agent 臃肿的东西

有关详细示例和想法，请参阅[扩展包指南](../docs/expansion-packs.md)。

### Agent 设计规则

1.  **Web/规划 Agent**：可以有更丰富的上下文、多个任务、广泛的模板
2.  **开发 Agent**：最小的依赖项，专注于代码生成，精简的任务集
3.  **所有 Agent**：清晰的角色，特定的专业知识，明确定义的能力

### 任务编写规则

1.  编写清晰的逐步程序
2.  使用 Markdown 格式以提高可读性
3.  保持开发 Agent 任务的专注和简洁
4.  规划任务可以更详尽
5.  **优先选择多个小任务，而不是一个大的分支任务**
    *   而不是一个具有许多条件路径的任务
    *   创建多个 Agent 可以选择的专注任务
    *   这使上下文开销保持最小
6.  **重用通用任务** - 不要创建新的文档创建任务
    *   使用现有的 `create-doc` 任务
    *   传递带有结构化部分的适当 YAML 模板
    *   这可以保持一致性并减少重复

### 模板规则

模板遵循使用 YAML 格式的 [BMad 文档模板](../common/utils/bmad-doc-template.md) 规范：

1.  **结构**：模板在 YAML 中定义，具有清晰的元数据、工作流配置和部分层次结构
2.  **关注点分离**：给 LLM 的指令在 `instruction` 字段中，与内容分开
3.  **可重用性**：模板与 Agent 无关，可以在不同的 Agent 之间使用
4.  **关键组件**：
    *   用于元数据（id、名称、版本、输出设置）的 `template` 块
    *   用于交互模式配置的 `workflow` 块
    *   定义具有嵌套子部分的文档结构的 `sections` 数组
    *   每个部分都有 `id`、`title` 和 `instruction` 字段
5.  **高级功能**：
    *   使用 `{{variable_name}}` 语法的变量替换
    *   带有 `condition` 字段的条件部分
    *   带有 `repeatable: true` 的可重复部分
    *   带有 `owner` 和 `editors` 字段的 Agent 权限
    *   用于指导的示例数组（从不包含在输出中）
6.  **纯净输出**：YAML 结构确保所有处理逻辑与生成的内容分开

## 记住

- 力量在于自然语言编排和人机协作，而不是代码
- 开发 Agent 编码，规划 Agent 规划
- 保持开发 Agent 精简以实现最大的编码效率
- 扩展包处理专业领域
